### callgraph-perl



根据保存图的目录中.graph，temp.svg和svg的存在情况来生成图



包括原始版本、比较版本、平台、真实/虚拟环境。

先把这些参数组成一个特定的形式，也就是最后生成SVG的文件名。

然后试着从已经生成的SVG图中读出匹配的图片，如果能够找到已经存在的图，则把它显示在页面上；如果在存放图的文件夹中没有找到相匹配的SVG图片。

画出SVG图。使用dot工具画出包含函数执行时间、静态、动态函数调用以及链接的函数调用图，具体命令为：

dot -Tsvg xxxx.graph -o xxxx-name.svg

在生成合并后的graph图之后，使用graphviz工具生成SVG图像。用dot工具画出包含静态、动态、函数执行时间以及各种功能链接的函数调用图SVG。这时的SVG图中并没有动态浮动菜单和点击菜单显示来显示函数调用关系。





### callgraph-sql.rb



根据用户输入生成函数调用图



第一步，生成函数调用图的节点。这是函数调用图的基本元素，本工具画出的节点可以代表模块、文件或函数，是想让用户能够更加清晰地了解模块或文件中间存在的函数调用关系。具体规则如下：当输入为目录时，则节点为该目录下的目录和文件，逐级返回并生成节点，直到根目录为止；当输入为文件时，则该文件里的函数为节点，并按上述规则继续生成节点，直到根目录为止。



第二步，确定顶点编号。为了统计方便，设定调用图中模块内部节点和外部节点颜色为不同的。按模块内、外顺序把节点按顺序编号，统计模块内、外节点的数目。所谓模块内节点为输入目录下的所有目录和文件节点，其余的节点则为模块外节点。



第三步，统计边的个数。函数调用图是有向图，在边计数时要计算双向，即A−> B和B−> A全要统计。函数调用图要求静态和动态调用分别进行输出，因此对静态调用和动态调用要分别统计。具体作法是读取一遍边数据，查找主调、被调函数属于哪两个的节点，同时该边计数加1。



第四步，计算每个节点内函数的总执行时间。对于函数而言需计算其本身的执行时间，而对于模块和文件而言则是该模块或文件内所有函数执行时间之和。



第五步，生成符合Graphviz的.graph格式的文件。




### script

文件中包含了与SVG图菜单项交互时所进行的处理，如控制分层的菜单、 控制分层菜单使各层显示和隐藏的函数、顶点和线的菜单、对顶点和线进行的操作等。（在处理SVG时会将这些元素与动作首先写入新的SVG图中，再进行边和节点的写入。）

